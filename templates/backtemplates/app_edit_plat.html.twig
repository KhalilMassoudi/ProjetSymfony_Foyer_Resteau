{% extends 'backtemplates/baseback2.html.twig' %}

{% block title %}
    Modifier le plat - {{ plat.nomPlat }}
{% endblock %}

{% block body %}
<div class="container mt-4" style="margin-left: 20%; margin-top: 80px; padding-top: 80px;">
    <h1>Modifier le plat</h1>

    {# Flash messages for success and error #}
    {% for message in app.flashes('success') %}
        <div class="alert alert-success">
            {{ message }}
        </div>
    {% endfor %}

    {% for message in app.flashes('error') %}
        <div class="alert alert-danger">
            {{ message }}
        </div>
    {% endfor %}

    {{ form_start(form, {'attr': {'class': 'form-horizontal', 'novalidate': 'novalidate'}}) }}

    {# Form fields with error handling #}
    <div class="row mb-3">
        <label for="{{ form.nomPlat.vars.id }}" class="col-sm-2 col-form-label">{{ form.nomPlat.vars.label }}</label>
        <div class="col-sm-10">
            {{ form_widget(form.nomPlat, {'attr': {'class': 'form-control'}}) }}
            {% if form.nomPlat.vars.errors|length > 0 %}
                <div class="alert alert-danger">
                    {% for error in form.nomPlat.vars.errors %}
                        <p>{{ error.message }}</p>
                    {% endfor %}
                </div>
            {% endif %}
        </div>
    </div>

    <div class="row mb-3">
        <label for="{{ form.descPlat.vars.id }}" class="col-sm-2 col-form-label">{{ form.descPlat.vars.label }}</label>
        <div class="col-sm-10">
            {{ form_widget(form.descPlat, {'attr': {'class': 'form-control'}}) }}
            {% if form.descPlat.vars.errors|length > 0 %}
                <div class="alert alert-danger">
                    {% for error in form.descPlat.vars.errors %}
                        <p>{{ error.message }}</p>
                    {% endfor %}
                </div>
            {% endif %}
        </div>
    </div>

    <div class="row mb-3">
        <label for="{{ form.prixPlat.vars.id }}" class="col-sm-2 col-form-label">{{ form.prixPlat.vars.label }}</label>
        <div class="col-sm-10">
            {{ form_widget(form.prixPlat, {'attr': {'class': 'form-control'}}) }}
            {% if form.prixPlat.vars.errors|length > 0 %}
                <div class="alert alert-danger">
                    {% for error in form.prixPlat.vars.errors %}
                        <p>{{ error.message }}</p>
                    {% endfor %}
                </div>
            {% endif %}
        </div>
    </div>

    <div class="row mb-3">
        <label for="{{ form.categoriePlat.vars.id }}" class="col-sm-2 col-form-label">{{ form.categoriePlat.vars.label }}</label>
        <div class="col-sm-10">
            {{ form_widget(form.categoriePlat, {'attr': {'class': 'form-control'}}) }}
            {% if form.categoriePlat.vars.errors|length > 0 %}
                <div class="alert alert-danger">
                    {% for error in form.categoriePlat.vars.errors %}
                        <p>{{ error.message }}</p>
                    {% endfor %}
                </div>
            {% endif %}
        </div>
    </div>

    <div class="row mb-3">
        <label for="{{ form.dispoPlat.vars.id }}" class="col-sm-2 col-form-label">{{ form.dispoPlat.vars.label }}</label>
        <div class="col-sm-10">
            {{ form_widget(form.dispoPlat, {'attr': {'class': 'form-control'}}) }}
            {% if form.dispoPlat.vars.errors|length > 0 %}
                <div class="alert alert-danger">
                    {% for error in form.dispoPlat.vars.errors %}
                        <p>{{ error.message }}</p>
                    {% endfor %}
                </div>
            {% endif %}
        </div>
    </div>

    <div class="row mb-3">
        <label for="{{ form.typeCuisine.vars.id }}" class="col-sm-2 col-form-label">{{ form.typeCuisine.vars.label }}</label>
        <div class="col-sm-10">
            {{ form_widget(form.typeCuisine, {'attr': {'class': 'form-control'}}) }}
            {% if form.typeCuisine.vars.errors|length > 0 %}
                <div class="alert alert-danger">
                    {% for error in form.typeCuisine.vars.errors %}
                        <p>{{ error.message }}</p>
                    {% endfor %}
                </div>
            {% endif %}
        </div>
    </div>

    {# Image handling, if there's an existing image #}
    {% if plat.image %}
        <div class="mb-3">
            <label class="form-label">Image actuelle :</label>
            <img src="{{ asset('uploads/images/' ~ plat.image) }}" alt="Image de {{ plat.nomPlat }}" style="width: 150px; height: auto;">
        </div>
    {% endif %}

    <div class="row mb-3">
        <label for="{{ form.image.vars.id }}" class="col-sm-2 col-form-label">{{ form.image.vars.label }}</label>
        <div class="col-sm-10">
            {{ form_widget(form.image, {'attr': {'class': 'form-control'}}) }}
        </div>
    </div>

    {# Submit and Cancel buttons #}
    <div class="card-body">
        <button type="submit" class="btn btn-primary">
            Enregistrer les modifications
            <span class="btn-icon-right"><i class="fa fa-save"></i></span>
        </button>
        <a href="{{ path('app_plat') }}" class="btn btn-secondary">
            Annuler
            <span class="btn-icon-right"><i class="fa fa-times"></i></span>
        </a>
    </div>

    {{ form_end(form) }}
</div>
{% endblock %}
{% block footer %}
{% endblock %}